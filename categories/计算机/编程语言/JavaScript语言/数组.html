<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="数组"><meta name="keywords" content=""><meta name="author" content="rcocco,rcocco@qq.com"><meta name="copyright" content="rcocco"><title>数组 | rcocco's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2f232b8a2af9088714735280ce974c8b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-193110637-1', 'auto');
ga('send', 'pageview');</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text"> 概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E7%BB%84"><span class="toc-number">2.</span> <span class="toc-text"> 创建数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E9%9D%A2%E5%80%BC"><span class="toc-number">2.1.</span> <span class="toc-text"> 字面值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#array%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.</span> <span class="toc-text"> Array构造函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E4%BC%A0%E9%80%92%E7%9A%84%E5%8F%82%E6%95%B0"><span class="toc-number">2.3.</span> <span class="toc-text"> 基于传递的参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8F%AF%E8%BF%AD%E4%BB%A3%E7%B1%BB%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.4.</span> <span class="toc-text"> 基于可迭代&#x2F;类数组对象</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%98%AF%E6%95%B0%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text"> 判断是否是数组</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%85%83%E7%B4%A0"><span class="toc-number">4.</span> <span class="toc-text"> 替换元素</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0"><span class="toc-number">5.</span> <span class="toc-text"> 添加元素</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E6%9C%AB%E5%B0%BE%E6%B7%BB%E5%8A%A0"><span class="toc-number">5.1.</span> <span class="toc-text"> 在末尾添加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E5%BC%80%E5%A4%B4%E6%B7%BB%E5%8A%A0"><span class="toc-number">5.2.</span> <span class="toc-text"> 在开头添加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E4%BB%BB%E6%84%8F%E4%BD%8D%E7%BD%AE%E6%B7%BB%E5%8A%A0"><span class="toc-number">5.3.</span> <span class="toc-text"> 在任意位置添加</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0"><span class="toc-number">6.</span> <span class="toc-text"> 删除元素</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%9C%AB%E5%B0%BE%E5%85%83%E7%B4%A0"><span class="toc-number">6.1.</span> <span class="toc-text"> 删除末尾元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">6.1.1.</span> <span class="toc-text"> 单个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">6.1.2.</span> <span class="toc-text"> 多个元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%BC%80%E5%A4%B4%E5%8D%95%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">6.2.</span> <span class="toc-text"> 删除开头单个元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E4%BD%8D%E7%BD%AE%E5%88%A0%E9%99%A4%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">6.3.</span> <span class="toc-text"> 任意位置删除多个元素</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%95%B0%E7%BB%84"><span class="toc-number">7.</span> <span class="toc-text"> 输出数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%BC%E5%BC%8F"><span class="toc-number">7.1.</span> <span class="toc-text"> 自定义格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E6%A0%BC%E5%BC%8F"><span class="toc-number">7.2.</span> <span class="toc-text"> 固定格式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E6%95%B0%E7%BB%84%E6%88%96%E5%85%83%E7%B4%A0"><span class="toc-number">8.</span> <span class="toc-text"> 合并数组或元素</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E6%96%B0%E6%95%B0%E7%BB%84"><span class="toc-number">8.1.</span> <span class="toc-text"> 返回新数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%8E%B0%E6%9C%89%E6%95%B0%E7%BB%84"><span class="toc-number">8.2.</span> <span class="toc-text"> 修改现有数组</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%88%AA%E5%8F%96%E6%95%B0%E7%BB%84"><span class="toc-number">9.</span> <span class="toc-text"> 截取数组</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E6%95%B0%E7%BB%84"><span class="toc-number">10.</span> <span class="toc-text"> 遍历数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-number">10.1.</span> <span class="toc-text"> 迭代器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">10.2.</span> <span class="toc-text"> 回调函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%9F%90%E5%85%83%E7%B4%A0"><span class="toc-number">11.</span> <span class="toc-text"> 是否存在某元素</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%B8%83%E5%B0%94%E5%80%BC"><span class="toc-number">11.1.</span> <span class="toc-text"> 返回布尔值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%B4%A2%E5%BC%95"><span class="toc-number">11.2.</span> <span class="toc-text"> 返回第一个索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E7%B4%A2%E5%BC%95"><span class="toc-number">11.3.</span> <span class="toc-text"> 返回最后一个索引</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0%E9%83%BD%E6%BB%A1%E8%B6%B3%E6%9D%A1%E4%BB%B6"><span class="toc-number">12.</span> <span class="toc-text"> 是否所有元素都满足条件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BB%A1%E8%B6%B3%E7%89%B9%E5%AE%9A%E6%9D%A1%E4%BB%B6%E7%9A%84%E5%85%83%E7%B4%A0"><span class="toc-number">13.</span> <span class="toc-text"> 满足特定条件的元素</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">13.1.</span> <span class="toc-text"> 是否存在</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0"><span class="toc-number">13.2.</span> <span class="toc-text"> 获取所有元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">13.3.</span> <span class="toc-text"> 获取第一个元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E5%80%BC"><span class="toc-number">13.3.1.</span> <span class="toc-text"> 获取元素值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%B4%A2%E5%BC%95"><span class="toc-number">13.3.2.</span> <span class="toc-text"> 获取元素索引</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%8E%9F%E6%95%B0%E7%BB%84"><span class="toc-number">14.</span> <span class="toc-text"> 修改原数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F"><span class="toc-number">14.1.</span> <span class="toc-text"> 数组排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E8%BD%AC%E6%95%B0%E7%BB%84"><span class="toc-number">14.2.</span> <span class="toc-text"> 反转数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A1%AB%E5%85%85%E6%95%B0%E7%BB%84"><span class="toc-number">14.3.</span> <span class="toc-text"> 填充数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E9%83%A8%E6%8B%B7%E8%B4%9D"><span class="toc-number">14.4.</span> <span class="toc-text"> 内部拷贝</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8D%E4%BF%AE%E6%94%B9%E5%8E%9F%E6%95%B0%E7%BB%84"><span class="toc-number">15.</span> <span class="toc-text"> 不修改原数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E6%96%B0%E6%95%B0%E7%BB%84"><span class="toc-number">15.1.</span> <span class="toc-text"> 映射新数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E5%B7%A6%E5%88%B0%E5%8F%B3%E5%BD%92%E5%B9%B6"><span class="toc-number">15.2.</span> <span class="toc-text"> 从左到右归并</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E5%8F%B3%E5%88%B0%E5%B7%A6%E5%BD%92%E5%B9%B6"><span class="toc-number">15.3.</span> <span class="toc-text"> 从右到左归并</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%95%E5%B9%B3%E6%95%B0%E7%BB%84"><span class="toc-number">15.4.</span> <span class="toc-text"> 展平数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%B7%B1%E5%BA%A6"><span class="toc-number">15.4.1.</span> <span class="toc-text"> 指定深度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E6%B7%B1%E5%BA%A6%E5%B9%B6%E6%98%A0%E5%B0%84"><span class="toc-number">15.4.2.</span> <span class="toc-text"> 固定深度并映射</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/avatar.jpg"></div><div class="author-info__name text-center">rcocco</div><div class="author-info__description text-center">personal blog</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/rcocco">我的Github</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">179</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">27</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/bg.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">rcocco's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/categories">分类</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">数组</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-14</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript%E8%AF%AD%E8%A8%80/">JavaScript语言</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="概述"><a class="markdownIt-Anchor" href="#概述"></a> 概述</h1>
<p>在JavaScript中，数组是一个具有<code>&quot;length&quot;</code>属性，以及一组属性键为<strong>数组索引</strong>的可枚举属性的对象。</p>
<p>“整数索引”是用作属性键的字符串，它是规范的数字字符串，即满足<code>ToString(ToNumber(P)) === P</code>的数字字符串，其数字值为<code>[+0, 2^53-1]</code>之间的整数。“数组索引”是整数索引，其数字值为<code>[+0, 2^32-2]</code>之间的整数，即满足<code>ToString(ToUint32(P)) === P</code>且<code>ToUint32(P)</code>不等于<code>2^32-1</code>。</p>
<span id="more"></span>
<p><code>&quot;length&quot;</code>属性的值应该是<code>[0, 2^32-1]</code>之间的整数，它应该大于每一个可配置的自有数组索引名的数字值。简单地说，如果最大的整数索引的数值为<code>n</code>，那么<code>&quot;length&quot;</code>属性的值应该为<code>n + 1</code>。<br />
通常把<code>length</code>属性称为数组的长度，把数组索引对应的值称为数组的元素。<br />
如果<code>[0, length-1]</code>范围内的某些数组索引不存在，则称这些不存在的数组索引的值为空元素。具有空元素的数组称为稀疏数组。</p>
<p>减少<code>&quot;length&quot;</code>属性的值具有副作用，它会删除数组索引在新旧<code>&quot;length&quot;</code>值之间的数组元素。如果这之间的属性存在不可配置属性，由于不可配置属性不能被删除，则<code>&quot;length&quot;</code>属性的值不会被修改为新长度，而是会被自动修改为：最大的不可配置属性的属性名对应数字值加1。</p>
<p>一个与数组类似的概念称为“类数组对象”，它是具有<code>&quot;length&quot;</code>属性，以及一组属性键为<strong>整数索引</strong>的可枚举属性的对象。但修改<code>&quot;length&quot;</code>属性不具有副作用。下列数组方法几乎都适用于类数组对象。</p>
<h1 id="创建数组"><a class="markdownIt-Anchor" href="#创建数组"></a> 创建数组</h1>
<h2 id="字面值"><a class="markdownIt-Anchor" href="#字面值"></a> 字面值</h2>
<p>可以通过字面值<code>[元素列表]</code>创建数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[]</span><br><span class="line">[表达式<span class="number">1</span>]</span><br><span class="line">[表达式<span class="number">1</span>, 表达式<span class="number">2</span>,]</span><br><span class="line">[表达式<span class="number">1</span>, , 表达式<span class="number">3</span>]</span><br><span class="line">[...返回可迭代对象的表达式, 表达式]</span><br></pre></td></tr></table></figure>
<p>元素列表由一个或多个表达式组成，每个表达式的结果都会作为数组元素。多个元素用逗号分隔，最后一个元素后面的逗号是可选的。<br />
元素也可以留空，留空的元素将导致数组索引增加，但不会在数组中存储任何内容，也就是形成了空元素。最后一个元素后面的逗号不会导致数组索引增加。<br />
每个表达式也可以是一个以<code>...</code>开头的返回可迭代对象的表达式，在构建数组的过程中会遍历可迭代对象，每个迭代值都会作为数组元素并递增数组索引。</p>
<h2 id="array构造函数"><a class="markdownIt-Anchor" href="#array构造函数"></a> Array构造函数</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>(lenth)</span><br><span class="line"><span class="built_in">Array</span>(...items)</span><br></pre></td></tr></table></figure>
<p>返回创建的数组，它有两种形式：</p>
<ul>
<li>第一种是传递一个Number值，这个Number值必须在32位无符号整数范围内，即<code>[0, 2^32-1]</code>，创建的数组的<code>length</code>属性将是这个Number值，但没有任何元素。</li>
<li>第二种是传递若干个作为数组元素的参数，每个参数都将按照顺序作为一个数组元素。</li>
</ul>
<p>当只传递一个参数，且这个参数不是Number值时，将采用第二种解释。<br />
为了避免单Number参数时的混乱，如果想基于传递的参数创建数组，建议使用<code>Array.of</code>方法，而不是第二种形式的构造函数。</p>
<p>使用与不使用<code>new</code>的效果完全相同。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Array</span>(<span class="params">...items</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">new</span>.target === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Array</span>(...items);</span><br><span class="line">  <span class="keyword">if</span>(items.length == <span class="number">1</span> &amp;&amp; <span class="keyword">typeof</span> items[<span class="number">0</span>] == <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(ToUint32(items[<span class="number">0</span>]) !== items[<span class="number">0</span>]) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">this</span>.length = items[<span class="number">0</span>];</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">      <span class="built_in">this</span>[i] = items[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="基于传递的参数"><a class="markdownIt-Anchor" href="#基于传递的参数"></a> 基于传递的参数</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.of(...items)</span><br><span class="line"><span class="built_in">Array</span>(...items) <span class="comment">// 传递1个参数时，该参数不能是Number类型</span></span><br></pre></td></tr></table></figure>
<p>传递若干个参数，每个参数都将按照顺序作为一个数组元素。返回创建的数组。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.of = <span class="function"><span class="keyword">function</span>(<span class="params">...items</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> A = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">    A[i] = items[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="基于可迭代类数组对象"><a class="markdownIt-Anchor" href="#基于可迭代类数组对象"></a> 基于可迭代/类数组对象</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(iterable, mapFn, mapFnThis);</span><br><span class="line"><span class="built_in">Array</span>.from(arrayLikeObj, mapFn, mapFnThis);</span><br></pre></td></tr></table></figure>
<p>它有两种形式：</p>
<ul>
<li>第一种第一个参数为一个可迭代对象，将迭代值作为新创建的数组的元素。</li>
<li>第二种第一个参数为一个类数组对象，将类数组对象的元素作为新创建数组的元素（从<code>&quot;0&quot;</code>属性键开始，往后<code>&quot;length&quot;</code>个属性）</li>
</ul>
<p>如果传递了<code>mapFn</code>且它是一个函数，则不是将迭代值/属性值直接作为数组元素，而是对每个迭代值/属性值应用<code>mapFn</code>，再将<code>mapFn</code>返回的结果作为数组元素。<br />
<code>mapFn</code>接受两个参数：迭代值/属性值<code>item</code>和它在新创建的数组中的索引<code>index</code>。<br />
<code>mapFnThis</code>是调用<code>mapFn</code>时所使用的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>mapFnThis</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>mapFnThis</code>也没有效果。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from = <span class="function"><span class="keyword">function</span>(<span class="params">items, mapFn, mapFnThis</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> mapping;</span><br><span class="line">  <span class="keyword">if</span>(mapFn === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    mapping = <span class="literal">false</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!IsCallable(mapfn)) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();;</span><br><span class="line">    mapping = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> A = [];</span><br><span class="line">  <span class="keyword">if</span>(items[<span class="built_in">Symbol</span>.iterator]) &#123;</span><br><span class="line">    <span class="keyword">let</span> result = &#123;<span class="attr">done</span>: <span class="literal">false</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span> ** <span class="number">53</span> - <span class="number">1</span> &amp;&amp; !result.done; i++) &#123;</span><br><span class="line">      result = it.next();</span><br><span class="line">      <span class="keyword">if</span>(mapping) A[i] = mapFn.call(mapFnThis, result.value, i);</span><br><span class="line">      <span class="keyword">else</span> A[i] = result.value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> len = items[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span>(mapping) A[i] = mapFn.call(mapFnThis, items[i], i);</span><br><span class="line">      <span class="keyword">else</span> A[i] = items[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="判断是否是数组"><a class="markdownIt-Anchor" href="#判断是否是数组"></a> 判断是否是数组</h1>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.isArray(arg)</span><br></pre></td></tr></table></figure>
<p>如果<code>arg</code>是<code>Array</code>的实例，或者使用<code>extends</code>子句继承了<code>Array</code>的类的实例，则返回<code>true</code>。否则返回<code>false</code></p>
<h1 id="替换元素"><a class="markdownIt-Anchor" href="#替换元素"></a> 替换元素</h1>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.splice(start, deleteCount, ...items)</span><br></pre></td></tr></table></figure>
<p>替换元素的操作会改变原有数组对象。<br />
从索引为<code>start</code>的元素开始，将<code>deleteCount</code>个元素替换为<code>items</code>参数中的元素。返回一个包含被删除元素（可能是空元素）的数组对象。<br />
索引<code>start</code>可以是负数，负数被加上数组长度，如果加完仍为负数，则令<code>start</code>为<code>0</code>。<br />
如果没有指定<code>deleteCount</code>，则替换从<code>start</code>开始往后的所有元素。<br />
<code>deleteCount</code>应该小于数组长度减去<code>start</code>，即被删除的元素不应该超过数组范围。如果超过了，则只删除到数组末尾元素。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.splice = <span class="function"><span class="keyword">function</span>(<span class="params">start, deleteCount, ...items</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  start = start &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max((len + start), <span class="number">0</span>):</span><br><span class="line">      <span class="built_in">Math</span>.min(start, len);</span><br><span class="line">  <span class="keyword">let</span> insertCount;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">arguments</span>.length == <span class="number">0</span>) &#123;</span><br><span class="line">    insertCount = <span class="number">0</span>;</span><br><span class="line">    deleteCount = <span class="number">0</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">arguments</span>.length == <span class="number">1</span>) &#123;</span><br><span class="line">    insertCount = <span class="number">0</span>;</span><br><span class="line">    deleteCount = len - start;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    insertCount = items.length;</span><br><span class="line">    deleteCount = <span class="built_in">Math</span>.min(<span class="built_in">Math</span>.max(deleteCount, <span class="number">0</span>), len - start);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(len + insertCount - deleteCount &gt; <span class="number">2</span>**<span class="number">53</span>-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">let</span> A = <span class="built_in">Array</span>(deleteCount);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; deleteCount; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>((start + k) <span class="keyword">in</span> O) &#123;</span><br><span class="line">      A[k] = O[start + k];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  A[<span class="string">&quot;length&quot;</span>] = deleteCount;</span><br><span class="line">  <span class="keyword">if</span>(insertCount &lt; deleteCount) &#123;</span><br><span class="line">   <span class="comment">// 将被删除元素右边的元素往左移动</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> k = start; k &lt; (len - deleteCount); k++) &#123;</span><br><span class="line">      <span class="comment">// 被处理的范围是[deleteCount + k, len)</span></span><br><span class="line">      <span class="keyword">if</span>((deleteCount + k) <span class="keyword">in</span> O) &#123;</span><br><span class="line">       <span class="comment">// deleteCount + start 被删除元素右边的元素索引</span></span><br><span class="line">       <span class="comment">// insertCount + start 添加元素后右边的元素索引</span></span><br><span class="line">        O[insertCount + k] = O[deleteCount + k];</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">delete</span> O[insertCount + k];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// len - deleteCount + insertCount 新数组长度</span></span><br><span class="line">    <span class="comment">// 清空范围[len - deleteCount + insertCount, len)</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> k = len; k &gt; (len - deleteCount + insertCount); k--) &#123;</span><br><span class="line">      <span class="keyword">delete</span> O[k-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(insertCount &gt; deleteCount) &#123;</span><br><span class="line">    <span class="comment">// 将被删除元素右边的元素往右移动</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> k = len - deleteCount - <span class="number">1</span>; k &gt;= start; k--) &#123;</span><br><span class="line">      <span class="comment">// 被处理的范围是[deleteCount + k, len)</span></span><br><span class="line">      <span class="keyword">if</span>((deleteCount + k) <span class="keyword">in</span> O) &#123;</span><br><span class="line">        O[insertCount + k] = O[deleteCount + k];</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">delete</span> O[insertCount + k];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = start, i = <span class="number">0</span>; i &lt; insertCount; i++, k++) &#123;</span><br><span class="line">    O[k] = items[i];</span><br><span class="line">  &#125;</span><br><span class="line">  O[<span class="string">&quot;length&quot;</span>] = len - deleteCount + insertCount;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="添加元素"><a class="markdownIt-Anchor" href="#添加元素"></a> 添加元素</h1>
<p>添加元素的操作会改变原有的数组对象。</p>
<h2 id="在末尾添加"><a class="markdownIt-Anchor" href="#在末尾添加"></a> 在末尾添加</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.push(...items); <span class="comment">// 多个元素</span></span><br><span class="line">A[A.length] = item; <span class="comment">// 单个元素，不适用于类数组</span></span><br></pre></td></tr></table></figure>
<p><code>push</code>从数组中索引为<code>length</code>的位置开始添加元素，返回添加完元素后数组的新长度。被添加的元素顺序和参数顺序一致。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.push = <span class="function"><span class="keyword">function</span>(<span class="params">...items</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len + items.length &gt; <span class="number">2</span>**<span class="number">53</span> - <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">of</span> items) &#123;</span><br><span class="line">    O[len] = item;</span><br><span class="line">    len++;</span><br><span class="line">  &#125;</span><br><span class="line">  O[<span class="string">&quot;length&quot;</span>] = len;</span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在开头添加"><a class="markdownIt-Anchor" href="#在开头添加"></a> 在开头添加</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unshift(...items); <span class="comment">// 多个元素</span></span><br></pre></td></tr></table></figure>
<p>从数组中索引为<code>0</code>的位置开始添加元素，原有的元素向后移动，返回添加完元素后数组的新长度。被添加的元素顺序和参数的顺序一致。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unshift = <span class="function"><span class="keyword">function</span>(<span class="params">...items</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len + items.length &gt; <span class="number">2</span>**<span class="number">53</span> - <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = len - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      O[k + items.length] = O[k]</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">delete</span> O[k + items.length]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; items.length; i++) &#123;</span><br><span class="line">    O[i] = items[i];</span><br><span class="line">  &#125;</span><br><span class="line">  O[<span class="string">&quot;length&quot;</span>] = len + items.length;</span><br><span class="line">  <span class="keyword">return</span> len + items.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在任意位置添加"><a class="markdownIt-Anchor" href="#在任意位置添加"></a> 在任意位置添加</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.splice(start, <span class="number">0</span>, ...items)</span><br></pre></td></tr></table></figure>
<p>从数组中索引为<code>start</code>的位置开始添加元素，原有的元素根据需要向后移动，返回空数组。被添加的元素顺序和参数的顺序一致。</p>
<h1 id="删除元素"><a class="markdownIt-Anchor" href="#删除元素"></a> 删除元素</h1>
<p>删除元素的操作会改变原有的数组对象。</p>
<h2 id="删除末尾元素"><a class="markdownIt-Anchor" href="#删除末尾元素"></a> 删除末尾元素</h2>
<h3 id="单个元素"><a class="markdownIt-Anchor" href="#单个元素"></a> 单个元素</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.pop()</span><br></pre></td></tr></table></figure>
<p>从数组中删除索引为<code>lenth - 1</code>的元素，返回这个被删除的元素，空元素会返回<code>undefined</code>。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.pop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span>) &#123;</span><br><span class="line">    O[<span class="string">&quot;length&quot;</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> newLen = len - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> element = O[newLen];</span><br><span class="line">    <span class="keyword">delete</span> O[newLen];</span><br><span class="line">    O[<span class="string">&quot;length&quot;</span>] = newLen;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="多个元素"><a class="markdownIt-Anchor" href="#多个元素"></a> 多个元素</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.length = A.length - n <span class="comment">// 不适用于类数组</span></span><br></pre></td></tr></table></figure>
<p>删除末尾<code>n</code>个元素。这个方法不适用于类数组对象。</p>
<h2 id="删除开头单个元素"><a class="markdownIt-Anchor" href="#删除开头单个元素"></a> 删除开头单个元素</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.shift()</span><br></pre></td></tr></table></figure>
<p>从数组中删除索引为<code>0</code>的元素，返回这个被删除的元素，空元素会返回<code>undefined</code>。<br />
删除后会使其他元素的索引减1。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.shift = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span>) &#123;</span><br><span class="line">    O[<span class="string">&quot;length&quot;</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> first = O[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">1</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      O[k-<span class="number">1</span>] = O[k];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">delete</span> O[k-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="任意位置删除多个元素"><a class="markdownIt-Anchor" href="#任意位置删除多个元素"></a> 任意位置删除多个元素</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.splice(start, deleteCount)</span><br></pre></td></tr></table></figure>
<p>从数组中删除索引从<code>start</code>开始，往后<code>deleteCount</code>个元素，返回包含被删除元素（可能是空元素）的数组。删除后会使<code>start + deleteCount</code>右边的元素索引减少<code>deleteCount</code>。</p>
<h1 id="输出数组"><a class="markdownIt-Anchor" href="#输出数组"></a> 输出数组</h1>
<p>这些方法的目的是将数组输出为字符串。</p>
<h2 id="自定义格式"><a class="markdownIt-Anchor" href="#自定义格式"></a> 自定义格式</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.join(sep = <span class="string">&quot;,&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>将数组元素使用<code>ToString</code>抽象方法转换为字符串，然后用分隔符<code>sep</code>连接这些字符串。默认的分隔符是逗号。<br />
如果数组元素是空元素，又或者元素值为<code>null</code>或<code>undefined</code>，则元素会作为空串来连接。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.join = <span class="function"><span class="keyword">function</span>(<span class="params">sep = <span class="string">&quot;,&quot;</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  sep = ToString(sep);</span><br><span class="line">  <span class="keyword">let</span> R = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k &gt; <span class="number">0</span>) R += sep;</span><br><span class="line">    <span class="keyword">let</span> element = O[k];</span><br><span class="line">    <span class="keyword">let</span> next;</span><br><span class="line">    <span class="keyword">if</span>(element === <span class="literal">null</span> || element == <span class="literal">undefined</span>) &#123;</span><br><span class="line">      next = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      next = ToString(element);</span><br><span class="line">    &#125;</span><br><span class="line">    R += next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> R;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="固定格式"><a class="markdownIt-Anchor" href="#固定格式"></a> 固定格式</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.toString() <span class="comment">// 不适用于类数组对象</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.toLocaleString() <span class="comment">// 适用于类数组对象</span></span><br></pre></td></tr></table></figure>
<p><code>toString()</code>方法会调用对象的<code>join()</code>方法并返回结果，如果没有<code>join</code>则返回<code>Object.prototype.toString</code>的结果。由于类数组对象不自带<code>join</code>方法，<code>toString()</code>方法会使用<code>Object.prototype.toString</code>，其结果可能不是我们想要的。</p>
<p><code>Array.prototype.toLocaleString()</code>与<code>join</code>类似，只是使用数组元素的<code>toLocaleString</code>方法将其转换为字符串，而不是用<code>ToString</code>抽象方法。另外，分隔符<code>sep</code>也是一个基于地区的、由实现定义的字符串。</p>
<p><code>toString</code>实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> func = O[<span class="string">&quot;join&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> func !== <span class="string">&#x27;function&#x27;</span>) func = <span class="built_in">Object</span>.prototype.toString;</span><br><span class="line">  <span class="keyword">return</span> func.call(O);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="合并数组或元素"><a class="markdownIt-Anchor" href="#合并数组或元素"></a> 合并数组或元素</h1>
<h2 id="返回新数组"><a class="markdownIt-Anchor" href="#返回新数组"></a> 返回新数组</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.concat(...items)</span><br></pre></td></tr></table></figure>
<p>此方法不改变原有数组。<br />
接受任意个参数，将<code>this</code>以及每个传递进来的参数自身，或者参数的元素添加到新数组中并返回。<br />
如果处理的参数对象没有<code>Symbol.isConcatSpreadable</code>属性，但<code>Array.isArray</code>为<code>true</code>。又或者具有<code>Symbol.isConcatSpreadable</code>属性且值为<code>true</code>，则将对象当成类数组对象，类数组对象的元素（从<code>&quot;0&quot;</code>属性键开始，往后<code>&quot;length&quot;</code>个属性，包括空元素）被添加到新创建的数组中。<br />
否则，将对象自身作为元素添加到新创建的数组中。</p>
<p><code>Symbol.isConcatSpreadable</code>属性对于DOM中的类数组对象十分有用，例如HTMLCollection，默认情况下由于<code>Array.isArray</code>返回<code>false</code>，<code>concat</code>并不会将HTMLCollection当成数组去添加它的元素。现在只需要设置<code>HTMLCollection.prototype[Symbol.isConcatSpreadable] = true</code>，就可以让<code>concat</code>将其当成类数组对象处理。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.concat = <span class="function"><span class="keyword">function</span>(<span class="params">...items</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> A = [];</span><br><span class="line">  <span class="keyword">let</span> n = <span class="number">0</span>;</span><br><span class="line">  items.unshift(O);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">of</span> items) &#123;</span><br><span class="line">    <span class="keyword">let</span> spreadable = item[<span class="built_in">Symbol</span>.isConcatSpreadable];</span><br><span class="line">    <span class="keyword">if</span>(spreadable === <span class="literal">undefined</span>) spreadable = <span class="built_in">Array</span>.isArray(item);</span><br><span class="line">    <span class="keyword">else</span> spreadable = <span class="built_in">Boolean</span>(spreadable);</span><br><span class="line">    <span class="keyword">if</span>(spreadable)&#123;</span><br><span class="line">      <span class="keyword">let</span> len = ToLength(item[<span class="string">&quot;length&quot;</span>]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(i <span class="keyword">in</span> item) &#123;</span><br><span class="line">          A[n] = item[i];</span><br><span class="line">        &#125;</span><br><span class="line">        n++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      A[n] = item[i];</span><br><span class="line">      n++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="修改现有数组"><a class="markdownIt-Anchor" href="#修改现有数组"></a> 修改现有数组</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.push(...arr1, ...arr2);</span><br></pre></td></tr></table></figure>
<p>将数组<code>arr1</code>和<code>arr2</code>添加到当前数组的末尾。</p>
<h1 id="截取数组"><a class="markdownIt-Anchor" href="#截取数组"></a> 截取数组</h1>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.slice(start, end = <span class="built_in">this</span>.length)</span><br></pre></td></tr></table></figure>
<p>此方法不改变原有数组。<br />
返回一个包含当前数组的<code>[start, end)</code>范围元素的数组，包括空元素。<br />
索引可以是负数，负数索引会被加上数组长度，如果加完仍是负数，则令索引为<code>0</code>。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.slice = <span class="function"><span class="keyword">function</span>(<span class="params">start = <span class="number">0</span>, end = <span class="built_in">this</span>.length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">let</span> k = start &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max(len + start, <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(start, len);</span><br><span class="line">  <span class="keyword">let</span> final = end &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max(len + end, <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(end, len);</span><br><span class="line">  <span class="keyword">let</span> count = <span class="built_in">Math</span>.max(final - k, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">let</span> A = <span class="built_in">Array</span>(count);</span><br><span class="line">  <span class="keyword">let</span> n = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(k &lt; final) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      A[n] = O[k];</span><br><span class="line">    &#125;</span><br><span class="line">    k++;</span><br><span class="line">    n++;</span><br><span class="line">  &#125;</span><br><span class="line">  A[<span class="string">&quot;length&quot;</span>] = n;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="遍历数组"><a class="markdownIt-Anchor" href="#遍历数组"></a> 遍历数组</h1>
<h2 id="迭代器"><a class="markdownIt-Anchor" href="#迭代器"></a> 迭代器</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.keys()</span><br><span class="line"><span class="built_in">Array</span>.prototype.values()</span><br><span class="line"><span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator]()</span><br><span class="line"><span class="built_in">Array</span>.prototype.entries()</span><br></pre></td></tr></table></figure>
<p>返回一个数组的迭代器。迭代时，空元素也会被迭代，其迭代元素是<code>undefined</code>。<br />
<code>key()</code>方法的迭代值<code>value</code>是迭代索引。<br />
<code>values()</code>方法和<code>Symbol.iterator</code>的迭代值<code>value</code>是迭代元素。<br />
<code>entries()</code>方法的迭代值<code>value</code>是一个长度为2的数组，第一个元素是迭代索引，第二个元素是迭代元素。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> [index, value] <span class="keyword">of</span> arr.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.entries = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ArrayIterator(O, <span class="string">&quot;key+value&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArrayIterator</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">array, kind</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.IteratedArrayLike = array;</span><br><span class="line">    <span class="built_in">this</span>.ArrayLikeNextIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">this</span>.ArrayLikeIterationKind = kind;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">next</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">this</span> !== <span class="string">&#x27;object&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">    <span class="keyword">let</span> a = <span class="built_in">this</span>.IteratedArrayLike;</span><br><span class="line">    <span class="keyword">if</span>(a === <span class="literal">undefined</span>) <span class="keyword">return</span> &#123;<span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span>&#125;;</span><br><span class="line">    <span class="keyword">let</span> index = <span class="built_in">this</span>.ArrayLikeNextIndex;</span><br><span class="line">    <span class="keyword">let</span> itemKind = <span class="built_in">this</span>.ArrayLikeIterationKind;</span><br><span class="line">    <span class="keyword">let</span> len = a[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span>(index &gt;= len) &#123;</span><br><span class="line">      <span class="built_in">this</span>.IteratedArrayLike = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.ArrayLikeNextIndex = index + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(itemKind == <span class="string">&#x27;key&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="attr">value</span>: index, <span class="attr">done</span>: <span class="literal">false</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> elementKey = <span class="built_in">String</span>(index);</span><br><span class="line">    <span class="keyword">let</span> elementValue = a[elementKey];</span><br><span class="line">    <span class="keyword">let</span> result;</span><br><span class="line">    <span class="keyword">if</span>(itemKind == <span class="string">&#x27;value&#x27;</span>) &#123;</span><br><span class="line">      result = elementValue;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      result = [index, elementValue];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">value</span>: result, <span class="attr">done</span>: <span class="literal">false</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="回调函数"><a class="markdownIt-Anchor" href="#回调函数"></a> 回调函数</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.forEach(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p><code>forEach</code>方法对当前数组的每个非空元素调用<code>cbFn</code>，并将元素值、索引值、数组对象传给<code>cbFn</code>。<br />
<code>cbThisArg</code>是调用<code>cbFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>cbFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>cbThisArg</code>也没有效果。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.forEach = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      cbFn.call(cbThisArg, O[k], k, O);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="是否存在某元素"><a class="markdownIt-Anchor" href="#是否存在某元素"></a> 是否存在某元素</h1>
<p><code>includes</code>、<code>indexOf</code>和<code>lastIndexOf</code>均用于检查是否存在某元素。<br />
除了返回值的差异，<code>includes</code>和<code>indexOf</code>/<code>lastIndexOf</code>还有两方面不同：<br />
<code>includes</code>使用SameValueZero算法，与严格相等运算符的区别在于它可以正确检测<code>NaN</code>。<code>indexOf</code>/<code>lastIndexOf</code>使用严格相等运算符进行比较。<br />
<code>includes</code>不会跳过空元素，它会将空元素作为<code>undefined</code>值进行比较。<code>indexOf</code>/<code>lastIndexOf</code>会跳过空元素。</p>
<h2 id="返回布尔值"><a class="markdownIt-Anchor" href="#返回布尔值"></a> 返回布尔值</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.includes(searchElement, fromIndex = <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>在当前数组中从索引<code>fromIndex</code>开始，检查是否存在一个元素<code>v</code>使得<code>SameValueZero(searchElement, v)</code>为<code>true</code>。如果存在则返回<code>true</code>，否则返回<code>false</code>。空元素也会被检查，空元素值被当做<code>undefined</code>。<br />
<code>fromIndex</code>可以是一个负数索引，此时它会被加上数组长度，如果加完仍是负数则令<code>fromIndex</code>为<code>0</code>。</p>
<p><code>includes</code>方法有意在两个方面与类似的<code>indexOf</code>方法不同。首先，它使用了SameValueZero算法，而不是严格相等性比较，允许它检测NaN数组元素。第二，它不跳过缺失的数组元素，而是将它们作为<code>undefined</code>处理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.includes = <span class="function"><span class="keyword">function</span>(<span class="params">searchElement, fromIndex = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">let</span> k = fromIndex &gt;= <span class="number">0</span> ? fromIndex : <span class="built_in">Math</span>.max(<span class="number">0</span>, len + fromIndex);</span><br><span class="line">  <span class="keyword">while</span>(k &lt; len) &#123;</span><br><span class="line">    <span class="keyword">if</span>(SameValueZero(searchElement, O[k])) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SameValueZero</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">Number</span>.isNaN(x) &amp;&amp; <span class="built_in">Number</span>.isNaN(y))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> x === y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="返回第一个索引"><a class="markdownIt-Anchor" href="#返回第一个索引"></a> 返回第一个索引</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.indexOf(searchElement, fromIndex = <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>在当前数组中从索引<code>fromIndex</code>开始，向后检查是否存在一个元素<code>v</code>使得<code>searchElement === v</code>为<code>true</code>。如果存在则返回该元素的索引，否则返回<code>-1</code>。存在多个元素时返回索引最小的那个。空元素不会被检查。<br />
<code>fromIndex</code>可以是一个负数索引，此时它会被加上数组长度，如果加完仍是负数则令<code>fromIndex</code>为<code>0</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.indexOf = <span class="function"><span class="keyword">function</span>(<span class="params">searchElement, fromIndex = <span class="number">0</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> k = fromIndex &gt;= <span class="number">0</span> ? fromIndex : <span class="built_in">Math</span>.max(<span class="number">0</span>, len + fromIndex);</span><br><span class="line">  <span class="keyword">while</span>(k &lt; len) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O &amp;&amp; searchElement === O[k]) <span class="keyword">return</span> k;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="返回最后一个索引"><a class="markdownIt-Anchor" href="#返回最后一个索引"></a> 返回最后一个索引</h2>
<p>在当前数组中从索引<code>fromIndex</code>开始，向前检查是否存在一个元素<code>v</code>使得<code>searchElement === v</code>为<code>true</code>。如果存在则返回该元素的索引，否则返回<code>-1</code>。存在多个元素时返回索引最大的那个。空元素不会被检查。<br />
<code>fromIndex</code>可以是一个负数索引，此时它会被加上数组长度，如果加完仍是负数则返回<code>-1</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.lastIndexOf = <span class="function"><span class="keyword">function</span>(<span class="params">searchElement, fromIndex = <span class="built_in">this</span>.length - <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> k = fromIndex &gt;= <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.min(fromIndex, len - <span class="number">1</span>) :</span><br><span class="line">      len + fromIndex;</span><br><span class="line">  <span class="keyword">while</span>(k &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O &amp;&amp; searchElement === O[k]) <span class="keyword">return</span> k;</span><br><span class="line">    k--;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="是否所有元素都满足条件"><a class="markdownIt-Anchor" href="#是否所有元素都满足条件"></a> 是否所有元素都满足条件</h1>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.every(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p><code>every</code>方法判断数组的元素是否都使得函数<code>cbFn</code>为<code>true</code>。<br />
按照升序索引，对每个非空元素调用<code>cbFn</code>并将元素值、索引值、数组对象传给<code>cbFn</code>。<br />
如果<code>cbFn</code>返回值为<code>false</code>则<code>every</code>返回<code>false</code>。如果所有元素都返回<code>true</code>则<code>every</code>返回<code>true</code>。<br />
<code>cbThisArg</code>是调用<code>cbFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>cbFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>cbThisArg</code>也没有效果。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.every = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O &amp;&amp; !cbFn.call(cbThisArg, O[k], k, O)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="满足特定条件的元素"><a class="markdownIt-Anchor" href="#满足特定条件的元素"></a> 满足特定条件的元素</h1>
<h2 id="是否存在"><a class="markdownIt-Anchor" href="#是否存在"></a> 是否存在</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.some(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p><code>some</code>方法判断数组中，是否存在使得函数<code>cbFn</code>为<code>true</code>的元素。<br />
按照升序索引，对每个非空元素调用<code>cbFn</code>并将元素值、索引值、数组对象传给<code>cbFn</code>。<br />
如果任何一次调用<code>cbFn</code>返回值为<code>true</code>则<code>some</code>返回<code>true</code>。如果所有元素都返回<code>false</code>则<code>some</code>返回<code>false</code>。<br />
<code>cbThisArg</code>是调用<code>cbFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>cbFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>cbThisArg</code>也没有效果。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.some = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O &amp;&amp; cbFn.call(cbThisArg, O[k], k, O)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取所有元素"><a class="markdownIt-Anchor" href="#获取所有元素"></a> 获取所有元素</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.filter(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p><code>filter</code>方法筛选出数组中使得<code>cbFn</code>为<code>true</code>的所有元素，返回由这些元素组成的新数组。<br />
按照升序索引，对每个非空元素调用<code>cbFn</code>并将元素值、索引值、数组对象传给<code>cbFn</code>。<br />
如果<code>cbFn</code>返回值为<code>true</code>则将该元素加入新数组。<br />
<code>cbThisArg</code>是调用<code>cbFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>cbFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>cbThisArg</code>也没有效果。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.filter = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">let</span> A = [];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      <span class="keyword">let</span> kValue = O[k];</span><br><span class="line">      <span class="keyword">if</span>(cbFn.call(cbThisArg, kValue, k, O))</span><br><span class="line">        A.push(kValue);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取第一个元素"><a class="markdownIt-Anchor" href="#获取第一个元素"></a> 获取第一个元素</h2>
<p><code>find</code>和<code>findIndex</code>方法获取数组中第一个使得<code>cbFn</code>为<code>true</code>的元素，返回这个元素值或者它的索引。如果没有使得<code>cbFn</code>为<code>true</code>的元素，则返回<code>undefined</code>或<code>-1</code>。<br />
按照升序索引，对每个元素（包括空元素，空元素值认为是<code>undefined</code>）调用<code>cbFn</code>并将元素值、索引值、数组对象传给<code>cbFn</code>。<br />
<code>cbThisArg</code>是调用<code>cbFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>cbFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>cbThisArg</code>也没有效果。</p>
<h3 id="获取元素值"><a class="markdownIt-Anchor" href="#获取元素值"></a> 获取元素值</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.find(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.find = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">let</span> kValue = O[k];</span><br><span class="line">    <span class="keyword">if</span>(cbFn.call(cbThisArg, kValue, k, O))</span><br><span class="line">      <span class="keyword">return</span> kValue;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取元素索引"><a class="markdownIt-Anchor" href="#获取元素索引"></a> 获取元素索引</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.findIndex(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.findIndex = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">let</span> kValue = O[k];</span><br><span class="line">    <span class="keyword">if</span>(cbFn.call(cbThisArg, kValue, k, O))</span><br><span class="line">      <span class="keyword">return</span> k;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="修改原数组"><a class="markdownIt-Anchor" href="#修改原数组"></a> 修改原数组</h1>
<p>这些方法都会修改数组本身。其返回值都是<code>this</code>也即数组对象本身。</p>
<h2 id="数组排序"><a class="markdownIt-Anchor" href="#数组排序"></a> 数组排序</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.sort(compareFn)</span><br></pre></td></tr></table></figure>
<p>对数组进行排序，<code>compareFn</code>是排序所用的比较函数。如果没有传递<code>compareFn</code>，则将元素转为字符串后再执行字符串比较，按升序排列。<br />
规范要求排序必须是稳定的，也就是说，比较函数认为相等的元素，必须保持原来的顺序。<br />
<code>compareFn</code>是一个接受两个参数<code>x</code>和<code>y</code>的函数：</p>
<ul>
<li>如果<code>x</code>要排在<code>y</code>前面，则返回负值，通常是<code>-1</code>。</li>
<li>如果<code>x</code>和<code>y</code>顺序是同级的，排在一起，维持原来的顺序，则返回<code>0</code>。</li>
<li>如果<code>x</code>要排在<code>y</code>后面，则返回正值，通常是<code>1</code>。</li>
</ul>
<p>更进一步说，<code>compareFn</code>应该是数组元素所组成的集合上的一致比较函数，即满足所有下列条件的函数：</p>
<ul>
<li>调用<code>compareFn(a, b)</code>不改变<code>obj</code>或<code>obj</code>原型链上的对象。</li>
<li><code>compareFn(a, a) = 0</code>（自反性）</li>
<li>如果<code>compareFn(a, b) = 0</code>，则<code>compareFn(b, a) = 0</code> (对称性)</li>
<li>如果<code>compareFn(a, b) = 0</code>且<code>compareFn(b, c)</code>，则<code>compareFn(a, c)</code> (相等时的传递性)</li>
<li>如果<code>compareFn(a, b) &lt; 0</code>且<code>compareFn(b, c) &lt; 0</code>，则<code>compareFn(a, c) &lt; 0</code> (小于时的传递性)</li>
<li>如果<code>compareFn(a, b) &gt; 0</code>且<code>compareFn(b, c) &gt; 0</code>，则<code>compareFn(a, c) &gt; 0</code> (大于时的传递性)</li>
</ul>
<p><code>sort</code>函数内部需要通过下面的<code>SortCompare</code>方法来调用用户传递的<code>compareFn</code>。<br />
因此，对于<code>undefined</code>元素，不会调用<code>compareFn</code>，而是认为<code>undefined</code>永远排在非<code>undefined</code>元素后面，两个<code>undefined</code>元素顺序是同级的。<br />
对于空元素，<code>sort</code>甚至不会调用<code>SortCompare</code>，而是认为空元素永远排在任何非空元素后面，两个空元素顺序是同级的。<br />
因此，排序完成后，数组中元素的顺序应该是：非空非<code>undefined</code>元素、<code>undefined</code>元素、空元素。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SortCompare</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x === <span class="literal">undefined</span> &amp;&amp; y === <span class="literal">undefined</span>) <span class="keyword">return</span> +<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(x === <span class="literal">undefined</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(y === <span class="literal">undefined</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(compareFn !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> v = ToNumber(compareFn.call(<span class="literal">undefined</span>, x, y));</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">Number</span>.isNaN(v)) <span class="keyword">return</span> +<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> xString = ToString(x);</span><br><span class="line">    <span class="keyword">let</span> yString = ToString(y);</span><br><span class="line">    <span class="keyword">if</span>(xString &lt; yString) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(yString &lt; xString) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="反转数组"><a class="markdownIt-Anchor" href="#反转数组"></a> 反转数组</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.reverse()</span><br></pre></td></tr></table></figure>
<p>反转数组元素，包括空元素。使得数组顺序变得和原来完全相反。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.reverse = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;this&quot;</span>];</span><br><span class="line">  <span class="keyword">let</span> middle = <span class="built_in">Math</span>.floor(len / <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">let</span> lower = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(lower != middle) &#123;</span><br><span class="line">    <span class="keyword">let</span> upper = len - lower - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> lowerExists = lower <span class="keyword">in</span> O;</span><br><span class="line">    <span class="keyword">let</span> lowerValue = lowerExists ? O[lower] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> upperExists = upper <span class="keyword">in</span> O;</span><br><span class="line">    <span class="keyword">let</span> upperValue = upperExists ? O[upper] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(lowerExists &amp;&amp; upperExists) &#123;</span><br><span class="line">      <span class="keyword">let</span> lowerVal = O[lower];</span><br><span class="line">      <span class="keyword">let</span> upperVal = O[upper];</span><br><span class="line">      O[lower] = upperValue;</span><br><span class="line">      O[upper] = lowerValue;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(!lowerExists &amp;&amp; upperExists) &#123;</span><br><span class="line">      O[lower] = upperValue;</span><br><span class="line">      <span class="keyword">delete</span> O[upper];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(lowerExists &amp;&amp; !upperExists) &#123;</span><br><span class="line">      <span class="keyword">delete</span> O[lower];</span><br><span class="line">      O[upper] = lowerValue;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line">    lower++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> O;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="填充数组"><a class="markdownIt-Anchor" href="#填充数组"></a> 填充数组</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.fill(value, start = <span class="number">0</span>, end = <span class="built_in">this</span>.length)</span><br></pre></td></tr></table></figure>
<p>将<code>[start, end)</code>范围内的索引对应的元素修改为<code>value</code>。<br />
索引可以为负数，负数索引会被加上数组长度。<br />
如果<code>[start, end)</code>中的索引大于等于数组长度，则不会填充这个索引对应的元素。因此空数组不管怎么调用该方法都没有效果。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.fill = <span class="function"><span class="keyword">function</span>(<span class="params">value, start = <span class="number">0</span>, end = <span class="built_in">this</span>.length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  len len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  start = start &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max((len + start), <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(start, len);</span><br><span class="line">  end = end &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max((len + end), <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(end, len);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = start; k &lt; end; k++) &#123;</span><br><span class="line">    O[k] = value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> O;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="内部拷贝"><a class="markdownIt-Anchor" href="#内部拷贝"></a> 内部拷贝</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.copyWithin(target, start, end = <span class="built_in">this</span>.length)</span><br></pre></td></tr></table></figure>
<p>此方法改变原有数组。<br />
将<code>[start, end)</code>之间的元素复制到从<code>target</code>开始的位置，如果从<code>target</code>开始没有足够的空间存放被复制的元素，则到数组末尾就停止。<br />
如果没有提供<code>end</code>，则<code>end</code>默认为数组长度。<br />
如果提供的三个索引参数是负数，则令索引加上数组长度，如果加完仍为负数，则令索引为<code>0</code>。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.copyWithin = <span class="function"><span class="keyword">function</span>(<span class="params">target, start, end = <span class="built_in">this</span>.length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  target = target &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max((len + target), <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(target, len);</span><br><span class="line">  start = start &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max((len + start), <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(start, len);</span><br><span class="line">  end = end &lt; <span class="number">0</span> ?</span><br><span class="line">      <span class="built_in">Math</span>.max((len + end), <span class="number">0</span>) :</span><br><span class="line">      <span class="built_in">Math</span>.min(end, len);</span><br><span class="line">  <span class="keyword">let</span> count = <span class="built_in">Math</span>.min(end - start, len - target);</span><br><span class="line">  <span class="comment">// O[2] = O[1]</span></span><br><span class="line">  <span class="comment">// O[3] = O[2]  start + i &gt;= target, i in [0, count-1]</span></span><br><span class="line">  <span class="comment">// O[4] = O[3]</span></span><br><span class="line">  <span class="comment">// or</span></span><br><span class="line">  <span class="comment">// O[1] = O[2]</span></span><br><span class="line">  <span class="comment">// O[2] = O[3]</span></span><br><span class="line">  <span class="keyword">if</span>(start &lt; target &amp;&amp; target &lt; start + count) &#123;</span><br><span class="line">    <span class="comment">// 倒着移</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = count - <span class="number">1</span>; i &gt;= <span class="number">0</span> ; i--) &#123;</span><br><span class="line">      <span class="keyword">if</span>(start + i <span class="keyword">in</span> O)</span><br><span class="line">        O[target + i] = O[start + i];</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">delete</span> O[target + i]; <span class="comment">// empty</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; count ; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span>(start + i <span class="keyword">in</span> O)</span><br><span class="line">        O[target + i] = O[start + i];</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">delete</span> O[target + i]; <span class="comment">// empty</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> O;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="不修改原数组"><a class="markdownIt-Anchor" href="#不修改原数组"></a> 不修改原数组</h1>
<h2 id="映射新数组"><a class="markdownIt-Anchor" href="#映射新数组"></a> 映射新数组</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.map(cbFn, cbThisArg)</span><br></pre></td></tr></table></figure>
<p>对当前数组的每个非空元素执行<code>cbFn</code>，将<code>cbFn</code>的返回值作为新数组的元素，最后返回新数组。<br />
空元素不会调用<code>cbFn</code>，而是会直接作为新数组的元素。<br />
<code>cbThisArg</code>是调用<code>cbFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>cbFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>cbThisArg</code>也没有效果。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.map = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, cbThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">let</span> A = <span class="built_in">Array</span>(len);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; len; k++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      <span class="keyword">let</span> kValue = O[k];</span><br><span class="line">      <span class="keyword">let</span> mappedValue = cbFn.call(cbThisArg, kValue, k, O);</span><br><span class="line">      A[k] = mappedValue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="从左到右归并"><a class="markdownIt-Anchor" href="#从左到右归并"></a> 从左到右归并</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.reduce(cbFn, initVal)</span><br></pre></td></tr></table></figure>
<p>对当前数组中每个（或除了第一个）非空元素调用<code>cbFn</code>，按照升序索引顺序调用，返回最后一次调用<code>cbFn</code>的返回值（如果没调用过则返回<code>initVal</code>）<br />
<code>cbFn</code>接受四个参数：<code>prevVal</code>（上一次调用<code>cbFn</code>的返回值）、<code>curVal</code>（当前元素值）、<code>curIndex</code>（当前元素的索引）、数组对象本身。<br />
如果传递了<code>initVal</code>，则对每个非空元素调用<code>cbFn</code>，第一次调用<code>cbFn</code>时<code>prevVal = initVal</code>。<br />
如果没有传递<code>initVal</code>，则对除了第一个之外的每个非空元素调用<code>cbFn</code>，第一次调用<code>cbFn</code>时，<code>prevVal</code>为第一个非空元素的值。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.reduce = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, initVal</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span> &amp;&amp; <span class="built_in">arguments</span>.length == <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">let</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> accumulator = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">arguments</span>.length != <span class="number">1</span>)&#123; <span class="comment">// initVal存在</span></span><br><span class="line">    accumulator = initVal;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> kPresent = <span class="literal">false</span>; <span class="comment">// 找第一个非空元素</span></span><br><span class="line">    <span class="keyword">while</span>(!kPresent &amp;&amp; k &lt; len) &#123;</span><br><span class="line">      kPresent = k <span class="keyword">in</span> O;</span><br><span class="line">      <span class="keyword">if</span>(kPresent) accumulator = O[k];</span><br><span class="line">      k++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!kPresent) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(k &lt; len) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      accumulator = cbFn.call(<span class="literal">undefined</span>, accumulator, O[k], k, O);</span><br><span class="line">    &#125;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> accumulator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="从右到左归并"><a class="markdownIt-Anchor" href="#从右到左归并"></a> 从右到左归并</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.reduceRight(cbFn, initVal)</span><br></pre></td></tr></table></figure>
<p>对当前数组中每个（或除了最后一个）非空元素调用<code>cbFn</code>，按照降序索引顺序调用，返回最后一次调用<code>cbFn</code>的返回值（如果没调用过则返回<code>initVal</code>）<br />
<code>cbFn</code>接受四个参数：<code>prevVal</code>（上一次调用<code>cbFn</code>的返回值）、<code>curVal</code>（当前元素值）、<code>curIndex</code>（当前元素的索引）、数组对象本身。<br />
如果传递了<code>initVal</code>，则对每个非空元素调用<code>cbFn</code>，第一次调用<code>cbFn</code>时<code>prevVal = initVal</code>。<br />
如果没有传递<code>initVal</code>，则对除了最后一个之外的每个非空元素调用<code>cbFn</code>，第一次调用<code>cbFn</code>时，<code>prevVal</code>为最后一个非空元素的值。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.reduceRight = <span class="function"><span class="keyword">function</span>(<span class="params">cbFn, initVal</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> len = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> cbFn !== <span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">if</span>(len == <span class="number">0</span> &amp;&amp; <span class="built_in">arguments</span>.length == <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">let</span> k = len - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> accumulator = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">arguments</span>.length != <span class="number">1</span>)&#123; <span class="comment">// initVal存在</span></span><br><span class="line">    accumulator = initVal;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> kPresent = <span class="literal">false</span>; <span class="comment">// 找最后一个非空元素</span></span><br><span class="line">    <span class="keyword">while</span>(!kPresent &amp;&amp; k &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">      kPresent = k <span class="keyword">in</span> O;</span><br><span class="line">      <span class="keyword">if</span>(kPresent) accumulator = O[k];</span><br><span class="line">      k--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!kPresent) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(k &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(k <span class="keyword">in</span> O) &#123;</span><br><span class="line">      accumulator = cbFn.call(<span class="literal">undefined</span>, accumulator, O[k], k, O);</span><br><span class="line">    &#125;</span><br><span class="line">    k--;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> accumulator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="展平数组"><a class="markdownIt-Anchor" href="#展平数组"></a> 展平数组</h2>
<p>此方法不改变原有数组。此方法只能展平数组，而不能展平类数组对象，因为在判断是否需要展平时使用的是<code>Array.isArray</code>。</p>
<h3 id="指定深度"><a class="markdownIt-Anchor" href="#指定深度"></a> 指定深度</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.flat(depth = <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>将当前数组的每个非空元素添加到新数组中，如果该元素是个数组，且该数组元素所处深度不超过<code>depth</code>，则将数组元素而不是数组本身添加到新数组中，如果这些元素中又有数组，则重复上述步骤。最后返回包含这些被展平元素的新数组。<br />
<code>[1,[2,[3,4,5],6]]</code>中元素<code>1</code>的深度为<code>0</code>，元素<code>2</code>的深度为<code>1</code>，元素<code>3</code>的深度为<code>2</code>。<code>flat(1)</code>将得到<code>[1,2,[3,4,5],6]</code>，<code>flat(2)</code>得到<code>[1,2,3,4,5,6]</code></p>
<p><code>concat()</code>类似于<code>flat(0)</code>，但区别在于<code>concat</code>的结果中会包含空元素，而<code>flat</code>不会。</p>
<p>其实现类似于：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.flat = <span class="function"><span class="keyword">function</span>(<span class="params">depth = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> sourceLen = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">let</span> A = [];</span><br><span class="line">  flatternIntoArray(A, O, sourceLen, <span class="number">0</span>, depth)</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatternIntoArray</span>(<span class="params">target, source, sourceLen, start, depth, mapperFn, mapperFnThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> targetIndex = target;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> sourceIndex = <span class="number">0</span>; sourceIndex &lt; sourceLen; sourceIndex++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(sourceIndex <span class="keyword">in</span> source) &#123;</span><br><span class="line">      <span class="keyword">let</span> element = source[sourceIndex];</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">typeof</span> mapperFunction == <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">        element = mapperFunction.call(thisArg, element, sourceIndex, source);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> shouldFlatten = depth &gt; <span class="number">0</span> ? <span class="built_in">Array</span>.isArray(element) : <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span>(shouldFlatten) &#123;</span><br><span class="line">        <span class="keyword">let</span> elementLen = element[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">        targetIndex = flatternIntoArray(target, element, elementLen, targetIndex, depth - <span class="number">1</span>);</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(targetIndex &gt;= <span class="number">2</span> ** <span class="number">53</span> - <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">        target[targetIndex] = element;</span><br><span class="line">        targetIndex++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> targetIndex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="固定深度并映射"><a class="markdownIt-Anchor" href="#固定深度并映射"></a> 固定深度并映射</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.flatMap(mapperFn, mapperFnThisArg)</span><br></pre></td></tr></table></figure>
<p>对当前数组的每个非空元素调用<code>mapperFn</code>，如果返回结果不是数组，则将返回结果添加到新数组中，如果返回结果是数组，则将这个数组的每个非空元素添加到新数组中。<br />
<code>mapperFn</code>函数接受三个参数，元素值、元素索引、元素所属的数组<br />
<code>mapperFnThisArg</code>是调用<code>mapperFn</code>的<code>this</code>值，如果没有传递则为<code>undefined</code>。如果<code>mapperFn</code>是箭头函数，那么其<code>this</code>值永远是定义箭头函数时包围它的词法作用域的<code>this</code>，传递了<code>mapperFnThisArg</code>也没有效果。</p>
<p><code>flatMap</code>只能展平深度为1的数组，<code>mapperFn</code>只会在深度为0的数组上调用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.flatMap = <span class="function"><span class="keyword">function</span>(<span class="params">mapperFn, mapperFnThisArg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> O = <span class="built_in">Object</span>(<span class="built_in">this</span>);</span><br><span class="line">  <span class="keyword">let</span> sourceLen = O[<span class="string">&quot;length&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> mapperFn != <span class="string">&#x27;function&#x27;</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</span><br><span class="line">  <span class="keyword">let</span> A = [];</span><br><span class="line">  flatternIntoArray(A, O, sourceLen, <span class="number">0</span>, <span class="number">1</span>, mapperFn, mapperFnThisArg);</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:rcocco@qq.com">rcocco</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://rcocco.github.io/categories/计算机/编程语言/JavaScript语言/数组.html">https://rcocco.github.io/categories/计算机/编程语言/JavaScript语言/数组.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://rcocco.github.io">rcocco's Blog</a>！</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript%E8%AF%AD%E8%A8%80/%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F.html"><i class="fa fa-chevron-left">  </i><span>时间和日期</span></a></div><div class="next-post pull-right"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/JavaScript%E8%AF%AD%E8%A8%80/%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81.html"><span>编码与解码</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'a2cb0efab90aafe77d70',
  clientSecret: '4ab6a1536933e9a284900f708bef988ffb8c152f',
  repo: 'gitalk_comments',
  owner: 'rcocco',
  admin: 'rcocco',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/bg.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2021 By rcocco</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>